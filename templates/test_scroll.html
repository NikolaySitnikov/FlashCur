<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Scroll Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            color: #fff;
            font-family: Arial, sans-serif;
        }

        .test-container {
            background: rgba(26, 26, 26, 0.7);
            border-radius: 20px;
            overflow-x: scroll !important;
            overflow-y: hidden !important;
            -webkit-overflow-scrolling: touch !important;
            touch-action: pan-x !important;
            scroll-behavior: auto !important;
            overscroll-behavior-x: contain !important;
            transform: none !important;
            transition: none !important;
            backface-visibility: hidden;
            perspective: 1000px;
            -webkit-transform: translate3d(0, 0, 0);
            border: 2px solid #00ff88;
            padding: 10px;
            margin: 20px 0;
        }

        .test-table {
            min-width: 900px;
            border-collapse: collapse;
            transform: none !important;
        }

        .test-table th,
        .test-table td {
            border: 1px solid #444;
            padding: 10px 15px;
            white-space: nowrap;
        }

        .test-table th {
            background: #333;
        }

        .instructions {
            background: #222;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .status {
            background: #1a1a1a;
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid #00ff88;
        }
    </style>
</head>

<body>
    <h1>Mobile Scroll Diagnostic Test</h1>

    <div class="instructions">
        <h3>Instructions:</h3>
        <ol>
            <li>On mobile: Swipe the table left/right</li>
            <li>Check if scroll position stays after release</li>
            <li>Look at "Scroll Position" number below</li>
        </ol>
    </div>

    <div class="status" id="scrollStatus">
        <strong>Scroll Position:</strong> <span id="scrollPos">0</span>px
        <br>
        <strong>Container Width:</strong> <span id="containerWidth">...</span>px
        <br>
        <strong>Table Width:</strong> <span id="tableWidth">...</span>px
        <br>
        <strong>Is Scrollable:</strong> <span id="isScrollable">...</span>
    </div>

    <h3>Test Table (swipe to scroll):</h3>
    <div class="test-container" id="testContainer">
        <table class="test-table">
            <thead>
                <tr>
                    <th>Column 1</th>
                    <th>Column 2</th>
                    <th>Column 3 (Pro)</th>
                    <th>Column 4</th>
                    <th>Column 5</th>
                    <th>Column 6 (Pro)</th>
                    <th>Column 7 (Pro)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Data 1</td>
                    <td>Data 2</td>
                    <td>Data 3</td>
                    <td>Data 4</td>
                    <td>Data 5</td>
                    <td>Data 6</td>
                    <td>Data 7</td>
                </tr>
                <tr>
                    <td>Row 2-1</td>
                    <td>Row 2-2</td>
                    <td>Row 2-3</td>
                    <td>Row 2-4</td>
                    <td>Row 2-5</td>
                    <td>Row 2-6</td>
                    <td>Row 2-7</td>
                </tr>
                <tr>
                    <td>Row 3-1</td>
                    <td>Row 3-2</td>
                    <td>Row 3-3</td>
                    <td>Row 3-4</td>
                    <td>Row 3-5</td>
                    <td>Row 3-6</td>
                    <td>Row 3-7</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="instructions">
        <h3>Expected Result:</h3>
        <ul>
            <li>✅ "Scroll Position" should change when you swipe</li>
            <li>✅ Number should STAY at that value after releasing finger</li>
            <li>❌ If it goes back to 0, scrolling is broken</li>
        </ul>
    </div>

    <script>
        const container = document.getElementById('testContainer');
        const scrollPos = document.getElementById('scrollPos');
        const containerWidth = document.getElementById('containerWidth');
        const tableWidth = document.getElementById('tableWidth');
        const isScrollable = document.getElementById('isScrollable');

        // Update scroll position
        container.addEventListener('scroll', function () {
            scrollPos.textContent = Math.round(this.scrollLeft);
        });

        // Update dimensions
        function updateDimensions() {
            const table = container.querySelector('table');
            containerWidth.textContent = container.clientWidth;
            tableWidth.textContent = table.scrollWidth;
            isScrollable.textContent = table.scrollWidth > container.clientWidth ? 'YES ✅' : 'NO ❌';
        }

        // Check dimensions on load and resize
        updateDimensions();
        window.addEventListener('resize', updateDimensions);

        // Log touch events for debugging
        container.addEventListener('touchstart', function (e) {
            console.log('Touch start:', e.touches[0].clientX);
        });

        container.addEventListener('touchmove', function (e) {
            console.log('Touch move:', e.touches[0].clientX, 'Scroll:', this.scrollLeft);
        });

        container.addEventListener('touchend', function (e) {
            console.log('Touch end - Final scroll:', this.scrollLeft);
            // Check if scroll resets after 100ms
            setTimeout(() => {
                const finalScroll = this.scrollLeft;
                if (finalScroll === 0) {
                    alert('❌ SNAP-BACK DETECTED! Scroll reset to 0');
                } else {
                    console.log('✅ Scroll position maintained:', finalScroll);
                }
            }, 100);
        });
    </script>
</body>

</html>