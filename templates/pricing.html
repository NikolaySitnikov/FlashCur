<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pricing - VolSpike</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=7.7">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pricing.css') }}?v=7.7">
</head>

<body>
    <div class="pricing-page">
        <!-- Header -->
        <header class="pricing-header">
            <div class="pricing-header-content">
                <a href="{{ url_for('index') if current_user.is_authenticated else url_for('auth.login') }}"
                    class="back-link">
                    <span class="back-icon">←</span>
                    <span class="back-text">Back to Dashboard</span>
                </a>

                <!-- Mobile Navigation Menu -->
                <div class="mobile-nav mobile-only">
                    <button class="mobile-menu-btn" id="mobileMenuBtn" onclick="toggleMobileMenu()">
                        <span class="menu-icon">☰</span>
                    </button>

                    <div class="mobile-menu" id="mobileMenu">
                        <div class="mobile-menu-header">
                            <h3>Navigation</h3>
                            <button class="close-menu-btn" onclick="toggleMobileMenu()">✕</button>
                        </div>

                        <div class="mobile-menu-content">
                            {% if current_user.is_authenticated %}
                            <div class="mobile-user-info">
                                <div class="mobile-user-email">{{ current_user.email }}</div>
                                <div class="mobile-user-tier tier-{{ current_user.tier }}">{{ current_user.tier_name }}
                                </div>
                            </div>

                            <a href="{{ url_for('index') }}" class="mobile-menu-item">
                                <span class="menu-icon">📊</span>
                                <span>Dashboard</span>
                            </a>

                            <a href="{{ url_for('profile') }}" class="mobile-menu-item">
                                <span class="menu-icon">⚙️</span>
                                <span>Profile & Settings</span>
                            </a>

                            <a href="{{ url_for('pricing') }}" class="mobile-menu-item">
                                <span class="menu-icon">💎</span>
                                <span>Pricing</span>
                            </a>

                            <a href="{{ url_for('auth.logout') }}" class="mobile-menu-item logout">
                                <span class="menu-icon">🚪</span>
                                <span>Logout</span>
                            </a>
                            {% else %}
                            <a href="{{ url_for('auth.login') }}" class="mobile-menu-item">
                                <span class="menu-icon">🔑</span>
                                <span>Login</span>
                            </a>

                            <a href="{{ url_for('auth.register') }}" class="mobile-menu-item">
                                <span class="menu-icon">📝</span>
                                <span>Register</span>
                            </a>

                            <a href="{{ url_for('pricing') }}" class="mobile-menu-item">
                                <span class="menu-icon">💎</span>
                                <span>Pricing</span>
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Hero Section -->
        <div class="pricing-hero">
            <div class="hero-badge">💎 Choose Your Plan</div>
            <h1 class="hero-title">Simple, Transparent Pricing</h1>
            <p class="hero-subtitle">Start free, upgrade when you need more power</p>

            {% if current_user.is_authenticated %}
            <div class="current-plan-banner">
                <span class="current-plan-icon">✨</span>
                You're currently on the <strong>{{ current_user.tier_name }} Plan</strong>
            </div>
            {% endif %}
        </div>

        <!-- Pricing Cards -->
        <div class="pricing-container">
            <!-- FREE TIER -->
            <div
                class="pricing-card {% if current_user.is_authenticated and current_user.tier == 0 %}current-tier{% endif %}">
                {% if current_user.is_authenticated and current_user.tier == 0 %}
                <div class="current-badge">Current Plan</div>
                {% endif %}

                <div class="tier-header">
                    <div class="tier-icon">🌱</div>
                    <h2 class="tier-name">Free</h2>
                    <div class="tier-price">
                        <span class="price-amount">$0</span>
                        <span class="price-period">/month</span>
                    </div>
                    <p class="tier-description">Perfect for getting started</p>
                </div>

                <div class="tier-features">
                    <div class="feature-item">
                        <span class="feature-icon">✅</span>
                        <span class="feature-text">Core dashboard access</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">✅</span>
                        <span class="feature-text">Auto-refresh every <strong>15 minutes</strong></span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">✅</span>
                        <span class="feature-text">Last <strong>10 volume alerts</strong></span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">✅</span>
                        <span class="feature-text">TradingView export (top 50)</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">✅</span>
                        <span class="feature-text">Dark/Light theme</span>
                    </div>
                    <div class="feature-item disabled">
                        <span class="feature-icon">❌</span>
                        <span class="feature-text">Email alerts</span>
                    </div>
                    <div class="feature-item disabled">
                        <span class="feature-icon">❌</span>
                        <span class="feature-text">Custom thresholds</span>
                    </div>
                    <div class="feature-item disabled">
                        <span class="feature-icon">❌</span>
                        <span class="feature-text">Additional metrics</span>
                    </div>
                </div>

                <div class="tier-cta">
                    {% if current_user.is_authenticated %}
                    {% if current_user.tier == 0 %}
                    <button class="cta-btn current" disabled>Your Current Plan</button>
                    {% else %}
                    <a href="{{ url_for('downgrade', tier=0) }}" class="cta-btn secondary">Downgrade</a>
                    {% endif %}
                    {% else %}
                    <a href="{{ url_for('auth.register') }}" class="cta-btn primary">Get Started Free</a>
                    {% endif %}
                </div>
            </div>

            <!-- PRO TIER -->
            <div
                class="pricing-card featured {% if current_user.is_authenticated and current_user.tier == 1 %}current-tier{% endif %}">
                <div class="popular-badge">Most Popular</div>

                {% if current_user.is_authenticated and current_user.tier == 1 %}
                <div class="current-badge">Current Plan</div>
                {% endif %}

                <div class="tier-header">
                    <div class="tier-icon">🚀</div>
                    <h2 class="tier-name">Pro</h2>
                    <div class="tier-price">
                        <span class="price-amount">$9.99</span>
                        <span class="price-period">/month</span>
                    </div>
                    <p class="tier-description">For active traders</p>
                </div>

                <div class="tier-features">
                    <div class="feature-item highlighted">
                        <span class="feature-icon">✨</span>
                        <span class="feature-text"><strong>Everything in Free, plus:</strong></span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">⚡</span>
                        <span class="feature-text">Faster refresh: <strong>5 minutes</strong></span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">📧</span>
                        <span class="feature-text"><strong>Email alerts</strong> for volume spikes</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">🎯</span>
                        <span class="feature-text"><strong>Custom alert thresholds</strong></span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">📊</span>
                        <span class="feature-text">Additional metrics (OI, liquidations)</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">📈</span>
                        <span class="feature-text">Last <strong>30 alerts</strong> history</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">💾</span>
                        <span class="feature-text">CSV/JSON export (unlimited)</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">🚫</span>
                        <span class="feature-text"><strong>Ad-free</strong> experience</span>
                    </div>
                </div>

                <div class="tier-cta">
                    {% if current_user.is_authenticated %}
                    {% if current_user.tier == 1 %}
                    <button class="cta-btn current" disabled>Your Current Plan</button>
                    {% elif current_user.tier < 1 %} <!-- Monthly Option -->
                        <a href="{{ url_for('create_checkout', tier=1, billing_cycle='monthly') }}"
                            class="cta-btn primary">
                            Upgrade to Pro - Monthly
                        </a>
                        <!-- Yearly Option -->
                        <a href="{{ url_for('create_checkout', tier=1, billing_cycle='yearly') }}"
                            class="cta-btn secondary"
                            style="margin-top: 0.5rem; display: block; width: 100%; padding: 1rem 2rem; font-size: 1.1rem; font-weight: 700; text-align: center; text-decoration: none; border-radius: 12px; background: rgba(255, 255, 255, 0.1); color: #ffffff; border: 2px solid #404040; transition: all 0.3s ease;">
                            Upgrade to Pro - Yearly (Save $20)
                        </a>
                        {% else %}
                        <a href="{{ url_for('downgrade', tier=1) }}" class="cta-btn secondary">Downgrade to Pro</a>
                        {% endif %}
                        {% else %}
                        <a href="{{ url_for('auth.register') }}" class="cta-btn primary">Start Free Trial</a>
                        {% endif %}
                </div>

                <div class="tier-note">💳 Secure payment powered by Stripe</div>
            </div>

            <!-- ELITE TIER -->
            <div
                class="pricing-card premium {% if current_user.is_authenticated and current_user.tier == 2 %}current-tier{% endif %}">
                {% if current_user.is_authenticated and current_user.tier == 2 %}
                <div class="current-badge">Current Plan</div>
                {% endif %}

                <div class="tier-header">
                    <div class="tier-icon">👑</div>
                    <h2 class="tier-name">Elite</h2>
                    <div class="tier-price">
                        <span class="price-amount">$29.99</span>
                        <span class="price-period">/month</span>
                    </div>
                    <p class="tier-description">For professional traders</p>
                </div>

                <div class="tier-features">
                    <div class="feature-item highlighted">
                        <span class="feature-icon">💎</span>
                        <span class="feature-text"><strong>Everything in Pro, plus:</strong></span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">⚡</span>
                        <span class="feature-text"><strong>Real-time updates</strong> (30 seconds)</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">📱</span>
                        <span class="feature-text"><strong>SMS + Telegram</strong> alerts</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">💬</span>
                        <span class="feature-text"><strong>Discord</strong> webhook integration</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">♾️</span>
                        <span class="feature-text"><strong>Unlimited</strong> alert history</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">📊</span>
                        <span class="feature-text">Integrated charts & analytics</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">📜</span>
                        <span class="feature-text"><strong>7-day historical</strong> data</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">🔌</span>
                        <span class="feature-text"><strong>API access</strong> for automation</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">🌐</span>
                        <span class="feature-text">Multi-exchange support (coming soon)</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">🎫</span>
                        <span class="feature-text"><strong>Priority support</strong></span>
                    </div>
                </div>

                <div class="tier-cta">
                    {% if current_user.is_authenticated %}
                    {% if current_user.tier == 2 %}
                    <button class="cta-btn current" disabled>Your Current Plan</button>
                    {% elif current_user.tier < 2 %} <!-- Monthly Option -->
                        <a href="{{ url_for('create_checkout', tier=2, billing_cycle='monthly') }}"
                            class="cta-btn primary">
                            Upgrade to Elite - Monthly
                        </a>
                        <!-- Yearly Option -->
                        <a href="{{ url_for('create_checkout', tier=2, billing_cycle='yearly') }}"
                            class="cta-btn secondary"
                            style="margin-top: 0.5rem; display: block; width: 100%; padding: 1rem 2rem; font-size: 1.1rem; font-weight: 700; text-align: center; text-decoration: none; border-radius: 12px; background: rgba(255, 255, 255, 0.1); color: #ffffff; border: 2px solid #404040; transition: all 0.3s ease;">
                            Upgrade to Elite - Yearly (Save $60)
                        </a>
                        {% endif %}
                        {% else %}
                        <a href="{{ url_for('auth.register') }}" class="cta-btn primary">Start Free Trial</a>
                        {% endif %}
                </div>

                <div class="tier-note">💳 Secure payment powered by Stripe</div>
            </div>
        </div>

        <!-- Feature Comparison Table -->
        <div class="comparison-section">
            <h2 class="comparison-title">Feature Comparison</h2>

            <div class="comparison-table-container">
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th class="feature-col">Feature</th>
                            <th class="tier-col">Free</th>
                            <th class="tier-col featured-col">Pro</th>
                            <th class="tier-col premium-col">Elite</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="feature-name">Auto-refresh interval</td>
                            <td>15 min</td>
                            <td class="featured-cell">5 min</td>
                            <td class="premium-cell">30 sec</td>
                        </tr>
                        <tr>
                            <td class="feature-name">Volume alerts shown</td>
                            <td>Last 10</td>
                            <td class="featured-cell">Last 30</td>
                            <td class="premium-cell">Unlimited</td>
                        </tr>
                        <tr>
                            <td class="feature-name">Watchlist export limit</td>
                            <td>Top 50</td>
                            <td class="featured-cell">Unlimited</td>
                            <td class="premium-cell">Unlimited</td>
                        </tr>
                        <tr>
                            <td class="feature-name">Email alerts</td>
                            <td>❌</td>
                            <td class="featured-cell">✅</td>
                            <td class="premium-cell">✅</td>
                        </tr>
                        <tr>
                            <td class="feature-name">SMS alerts</td>
                            <td>❌</td>
                            <td class="featured-cell">❌</td>
                            <td class="premium-cell">✅</td>
                        </tr>
                        <tr>
                            <td class="feature-name">Telegram/Discord alerts</td>
                            <td>❌</td>
                            <td class="featured-cell">❌</td>
                            <td class="premium-cell">✅</td>
                        </tr>
                        <tr>
                            <td class="feature-name">Additional metrics (OI, liquidations)</td>
                            <td>❌</td>
                            <td class="featured-cell">✅</td>
                            <td class="premium-cell">✅</td>
                        </tr>
                        <tr>
                            <td class="feature-name">CSV/JSON export</td>
                            <td>❌</td>
                            <td class="featured-cell">✅</td>
                            <td class="premium-cell">✅</td>
                        </tr>
                        <tr>
                            <td class="feature-name">Historical data</td>
                            <td>❌</td>
                            <td class="featured-cell">❌</td>
                            <td class="premium-cell">7 days</td>
                        </tr>
                        <tr>
                            <td class="feature-name">API access</td>
                            <td>❌</td>
                            <td class="featured-cell">❌</td>
                            <td class="premium-cell">✅</td>
                        </tr>
                        <tr>
                            <td class="feature-name">Priority support</td>
                            <td>❌</td>
                            <td class="featured-cell">❌</td>
                            <td class="premium-cell">✅</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- FAQ Section -->
        <div class="faq-section">
            <h2 class="faq-title">Frequently Asked Questions</h2>

            <div class="faq-grid">
                <div class="faq-item">
                    <h3 class="faq-question">Can I switch plans anytime?</h3>
                    <p class="faq-answer">Yes! You can upgrade or downgrade your plan at any time. Changes take effect
                        immediately.</p>
                </div>

                <div class="faq-item">
                    <h3 class="faq-question">Do you offer refunds?</h3>
                    <p class="faq-answer">We offer a 14-day money-back guarantee for all paid plans. No questions asked.
                    </p>
                </div>

                <div class="faq-item">
                    <h3 class="faq-question">What payment methods do you accept?</h3>
                    <p class="faq-answer">We accept all major credit cards (Visa, Mastercard, AmEx), PayPal, and
                        cryptocurrency.</p>
                </div>

                <div class="faq-item">
                    <h3 class="faq-question">Is there a free trial for paid plans?</h3>
                    <p class="faq-answer">Start with the Free plan to test the dashboard. Upgrade anytime when you're
                        ready for more features.</p>
                </div>

                <div class="faq-item">
                    <h3 class="faq-question">Can I cancel my subscription?</h3>
                    <p class="faq-answer">Yes, you can cancel anytime from your account settings. You'll retain access
                        until the end of your billing period.</p>
                </div>

                <div class="faq-item">
                    <h3 class="faq-question">Do you offer team/enterprise plans?</h3>
                    <p class="faq-answer">Yes! Contact us for custom enterprise pricing with multi-user accounts and
                        dedicated support.</p>
                </div>
            </div>
        </div>

        <!-- Footer CTA -->
        <div class="pricing-footer-cta">
            <h2 class="footer-cta-title">Ready to get started?</h2>
            <p class="footer-cta-text">Join thousands of traders using VolSpike</p>
            <div class="footer-cta-buttons">
                {% if not current_user.is_authenticated %}
                <a href="{{ url_for('auth.register') }}" class="cta-btn primary large">Start Free</a>
                <a href="{{ url_for('auth.login') }}" class="cta-btn secondary large">Sign In</a>
                {% else %}
                <a href="{{ url_for('index') }}" class="cta-btn primary large">Go to Dashboard</a>
                {% endif %}
            </div>
        </div>
    </div>

    <script>
        // Mobile menu functionality
        function toggleMobileMenu() {
            console.log('toggleMobileMenu called'); // Debug log
            const menu = document.getElementById('mobileMenu');
            const btn = document.getElementById('mobileMenuBtn');

            if (menu.style.display === 'block') {
                menu.style.display = 'none';
                btn.innerHTML = '<span class="menu-icon">☰</span>';
            } else {
                menu.style.display = 'block';
                btn.innerHTML = '<span class="menu-icon">✕</span>';
            }
        }

        // Add event listener for better mobile support
        document.addEventListener('DOMContentLoaded', function () {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Mobile menu button clicked'); // Debug log
                    toggleMobileMenu();
                });

                // Also add touch events for mobile
                mobileMenuBtn.addEventListener('touchend', function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Mobile menu button touched'); // Debug log
                    toggleMobileMenu();
                });
            }
        });

        // Close menu when clicking outside
        document.addEventListener('click', function (event) {
            const menu = document.getElementById('mobileMenu');
            const btn = document.getElementById('mobileMenuBtn');

            if (menu && !menu.contains(event.target) && !btn.contains(event.target)) {
                menu.style.display = 'none';
                btn.innerHTML = '<span class="menu-icon">☰</span>';
            }
        });

        // AGGRESSIVE FIX: Prevent table overscroll behavior
        const comparisonTableContainer = document.querySelector('.comparison-table-container');
        if (comparisonTableContainer) {
            let isScrolling = false;
            let startX = 0;
            let scrollLeft = 0;

            // Prevent touch overscroll
            comparisonTableContainer.addEventListener('touchstart', function (e) {
                isScrolling = true;
                startX = e.touches[0].pageX - comparisonTableContainer.offsetLeft;
                scrollLeft = comparisonTableContainer.scrollLeft;
            }, { passive: false });

            comparisonTableContainer.addEventListener('touchmove', function (e) {
                if (!isScrolling) return;

                e.preventDefault();
                e.stopPropagation();

                const x = e.touches[0].pageX - comparisonTableContainer.offsetLeft;
                const walk = (x - startX) * 2;
                const newScrollLeft = scrollLeft - walk;

                // Constrain scrolling to actual content bounds
                const maxScroll = comparisonTableContainer.scrollWidth - comparisonTableContainer.clientWidth;
                const constrainedScroll = Math.max(0, Math.min(newScrollLeft, maxScroll));

                comparisonTableContainer.scrollLeft = constrainedScroll;
            }, { passive: false });

            comparisonTableContainer.addEventListener('touchend', function (e) {
                isScrolling = false;
            }, { passive: false });

            // Prevent mouse wheel overscroll
            comparisonTableContainer.addEventListener('wheel', function (e) {
                e.preventDefault();
                e.stopPropagation();

                const delta = e.deltaY;
                const currentScroll = comparisonTableContainer.scrollLeft;
                const maxScroll = comparisonTableContainer.scrollWidth - comparisonTableContainer.clientWidth;

                let newScroll = currentScroll + delta;
                newScroll = Math.max(0, Math.min(newScroll, maxScroll));

                comparisonTableContainer.scrollLeft = newScroll;
            }, { passive: false });

            // Reset scroll position if it goes beyond bounds
            comparisonTableContainer.addEventListener('scroll', function () {
                const maxScroll = comparisonTableContainer.scrollWidth - comparisonTableContainer.clientWidth;
                if (comparisonTableContainer.scrollLeft < 0) {
                    comparisonTableContainer.scrollLeft = 0;
                } else if (comparisonTableContainer.scrollLeft > maxScroll) {
                    comparisonTableContainer.scrollLeft = maxScroll;
                }
            });

            // Force reset scroll position on page load
            window.addEventListener('load', function () {
                comparisonTableContainer.scrollLeft = 0;
            });
        }
    </script>
</body>

</html>